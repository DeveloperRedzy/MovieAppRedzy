{"ast":null,"code":"import _asyncToGenerator from \"/Users/redzy/MovieAppRedzy/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"./search.service\";\nexport class SeriesDataService {\n  constructor(http, searchService) {\n    this.http = http;\n    this.searchService = searchService;\n    this.dataSource = new BehaviorSubject([]);\n    this.data = this.dataSource.asObservable();\n    this.apiKey = '50c817a98f088ecfaaf8483ad5df9597';\n  }\n\n  changeData(res) {\n    this.dataSource.next(res);\n  }\n\n  getSeries() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      _this.searchService.updateIsSearching(true);\n\n      const firstPage = yield _this.http.get(`https://api.themoviedb.org/3/tv/top_rated?api_key=${_this.apiKey}&language=en-US&page=1`).toPromise();\n      const secondPage = yield _this.http.get(`https://api.themoviedb.org/3/tv/top_rated?api_key=${_this.apiKey}&language=en-US&page=2`).toPromise();\n\n      _this.changeData([...firstPage.results, ...secondPage.results.slice(10)]);\n\n      _this.searchService.updateIsSearching(false);\n    })();\n  }\n\n  searchSeries(query) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      if (query.length > 2) {\n        _this2.searchService.updateIsSearching(true);\n\n        const series = yield _this2.http.get(`https://api.themoviedb.org/3/search/tv?api_key=${_this2.apiKey}&language=en-US&query=${query}&page=1&include_adult=false`).toPromise();\n\n        _this2.changeData([...series.results]);\n\n        _this2.searchService.updateIsSearching(false);\n      } else if (!query.length) _this2.getSeries();\n    })();\n  }\n\n  getSerieDetails(id) {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      const data = yield _this3.http.get(`https://api.themoviedb.org/3/tv/${id}?api_key=${_this3.apiKey}&language=en-US`).toPromise();\n      return data;\n    })();\n  }\n\n}\n\nSeriesDataService.ɵfac = function SeriesDataService_Factory(t) {\n  return new (t || SeriesDataService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.SearchService));\n};\n\nSeriesDataService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: SeriesDataService,\n  factory: SeriesDataService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"sources":["/Users/redzy/MovieAppRedzy/src/app/series-data.service.ts"],"names":[],"mappings":";AAEA,SAAS,eAAT,QAAgC,MAAhC;;;;AA8BA,OAAM,MAAO,iBAAP,CAAwB;AAC5B,EAAA,WAAA,CAAoB,IAApB,EAA8C,aAA9C,EAA0E;AAAtD,SAAA,IAAA,GAAA,IAAA;AAA0B,SAAA,aAAA,GAAA,aAAA;AACtC,SAAA,UAAA,GAAa,IAAI,eAAJ,CAA6B,EAA7B,CAAb;AACR,SAAA,IAAA,GAAO,KAAK,UAAL,CAAgB,YAAhB,EAAP;AACA,SAAA,MAAA,GAAS,kCAAT;AAH8E;;AAK9E,EAAA,UAAU,CAAC,GAAD,EAAa;AACrB,SAAK,UAAL,CAAgB,IAAhB,CAAqB,GAArB;AACD;;AAEK,EAAA,SAAS,GAAA;AAAA;;AAAA;AACb,MAAA,KAAI,CAAC,aAAL,CAAmB,iBAAnB,CAAqC,IAArC;;AACA,YAAM,SAAS,SAAiB,KAAI,CAAC,IAAL,CAC7B,GAD6B,CAE5B,qDAAqD,KAAI,CAAC,MAAM,wBAFpC,EAI7B,SAJ6B,EAAhC;AAKA,YAAM,UAAU,SAAiB,KAAI,CAAC,IAAL,CAC9B,GAD8B,CAE7B,qDAAqD,KAAI,CAAC,MAAM,wBAFnC,EAI9B,SAJ8B,EAAjC;;AAKA,MAAA,KAAI,CAAC,UAAL,CAAgB,CAAC,GAAG,SAAS,CAAC,OAAd,EAAuB,GAAG,UAAU,CAAC,OAAX,CAAmB,KAAnB,CAAyB,EAAzB,CAA1B,CAAhB;;AACA,MAAA,KAAI,CAAC,aAAL,CAAmB,iBAAnB,CAAqC,KAArC;AAba;AAcd;;AACK,EAAA,YAAY,CAAC,KAAD,EAAc;AAAA;;AAAA;AAC9B,UAAI,KAAK,CAAC,MAAN,GAAe,CAAnB,EAAsB;AACpB,QAAA,MAAI,CAAC,aAAL,CAAmB,iBAAnB,CAAqC,IAArC;;AACA,cAAM,MAAM,SAAiB,MAAI,CAAC,IAAL,CAC1B,GAD0B,CAEzB,kDAAkD,MAAI,CAAC,MAAM,yBAAyB,KAAK,6BAFlE,EAI1B,SAJ0B,EAA7B;;AAKA,QAAA,MAAI,CAAC,UAAL,CAAgB,CAAC,GAAG,MAAM,CAAC,OAAX,CAAhB;;AACA,QAAA,MAAI,CAAC,aAAL,CAAmB,iBAAnB,CAAqC,KAArC;AACD,OATD,MASO,IAAI,CAAC,KAAK,CAAC,MAAX,EAAmB,MAAI,CAAC,SAAL;AAVI;AAW/B;;AACK,EAAA,eAAe,CAAC,EAAD,EAAW;AAAA;;AAAA;AAC9B,YAAM,IAAI,SAAuB,MAAI,CAAC,IAAL,CAC9B,GAD8B,CAE7B,mCAAmC,EAAE,YAAY,MAAI,CAAC,MAAM,iBAF/B,EAI9B,SAJ8B,EAAjC;AAKA,aAAO,IAAP;AAN8B;AAO/B;;AA5C2B;;;mBAAjB,iB,EAAiB,EAAA,CAAA,QAAA,CAAA,EAAA,CAAA,UAAA,C,EAAA,EAAA,CAAA,QAAA,CAAA,EAAA,CAAA,aAAA,C;AAAA,C;;;SAAjB,iB;AAAiB,EAAA,OAAA,EAAjB,iBAAiB,CAAA,I;AAAA,EAAA,UAAA,EAFhB","sourcesContent":["import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { BehaviorSubject } from 'rxjs';\nimport { SearchService } from './search.service';\nimport { SerieDetails } from './serie-details/serie-details.component';\n\nexport interface Serie {\n  backdrop_path: string;\n  first_air_date: string;\n  genre_ids: number[];\n  id: number;\n  name: string;\n  origin_country: string[];\n  original_language: string;\n  original_name: string;\n  overview: string;\n  popularity: number;\n  poster_path: string;\n  vote_average: number;\n  vote_count: number;\n}\n\nexport interface Series {\n  page: number;\n  results: Serie[];\n  total_pages: number;\n  total_results: number;\n}\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class SeriesDataService {\n  constructor(private http: HttpClient, private searchService: SearchService) {}\n  private dataSource = new BehaviorSubject<Serie[]>([]);\n  data = this.dataSource.asObservable();\n  apiKey = '50c817a98f088ecfaaf8483ad5df9597';\n\n  changeData(res: Serie[]) {\n    this.dataSource.next(res);\n  }\n\n  async getSeries() {\n    this.searchService.updateIsSearching(true);\n    const firstPage: Series = await this.http\n      .get<Series>(\n        `https://api.themoviedb.org/3/tv/top_rated?api_key=${this.apiKey}&language=en-US&page=1`\n      )\n      .toPromise();\n    const secondPage: Series = await this.http\n      .get<Series>(\n        `https://api.themoviedb.org/3/tv/top_rated?api_key=${this.apiKey}&language=en-US&page=2`\n      )\n      .toPromise();\n    this.changeData([...firstPage.results, ...secondPage.results.slice(10)]);\n    this.searchService.updateIsSearching(false);\n  }\n  async searchSeries(query: string) {\n    if (query.length > 2) {\n      this.searchService.updateIsSearching(true);\n      const series: Series = await this.http\n        .get<Series>(\n          `https://api.themoviedb.org/3/search/tv?api_key=${this.apiKey}&language=en-US&query=${query}&page=1&include_adult=false`\n        )\n        .toPromise();\n      this.changeData([...series.results]);\n      this.searchService.updateIsSearching(false);\n    } else if (!query.length) this.getSeries();\n  }\n  async getSerieDetails(id: number) {\n    const data: SerieDetails = await this.http\n      .get<SerieDetails>(\n        `https://api.themoviedb.org/3/tv/${id}?api_key=${this.apiKey}&language=en-US`\n      )\n      .toPromise();\n    return data;\n  }\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}